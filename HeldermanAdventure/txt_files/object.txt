#include <stdbool.h>
#include <stdio.h>
#include "object.h"
#include "toggle.h"

typedef struct object
{
    bool (*condition)(void);
    const char *description;
    const char **tags;
    struct object *location;
    struct object *destination;
    struct object *prospect;
    const char *details;
    const char *contents;
    const char *textGo;
    int weight;
    int capacity;
    int health;
    void (*open)(void);
    void (*close)(void);
    void (*lock)(void);
    void (*unlock)(void);
} OBJECT;

extern OBJECT objs[];

- field
    description "an open grassy field"
    tags        "field"
    details     "The grassy field is a wide and calming space under a nightime sky."
    capacity    9999

- cave
    description "a little dark mountanside cave"
    tags        "cave"
    details     "The mountainside cave is a cold, dark, and rocky chamber."
    capacity    9999

- forest
    description "dark miasma laden dark forest"
    tags        "forest"
    details     "The forest is an old, dark, and aged area with a tree cover obscuring the sky."
    capacity    9999

- silver
    description "a shining silver coin"
    tags        "silver", "coin", "silver coin"
    location    field
    details     "The coin has stalks of wheat tiede with a ribbon engraved onto it."
    weight      1

- gold
    description "a blessed lustrous golden coin"
    tags        "gold", "coin", "gold coin"
    location    openBox
    details     "The coin is old and clearly has no known denomination and is a priceless aretefact."
    weight      1

- guard
    description "a burly guard"
    tags        "guard", "burly guard"
    location    field
    details     "The guard is a big and burly guy."
    contents    "He has"
    health      100
    capacity    20

- basket
    description "a worn out brown basket"
    tags        "basket"
    location    forest
    details     "The basket is an wood woven creation with a few holes in it."
    weight      3
    capacity    60

- player
    description "yourself"
    tags        "yourself"
    location    field
    details     "You need a mirror or reflective surface to view yourself."
    contents    "You have"
    health      100
    capacity    20

- enterCave
    condition   { return guard->health == 0 || silver->location == guard; }
    description "a cave entrance to the east"
    tags        "east", "entrance"
    location    field
    destination cave
    details     "The entrace is a wide opening in the mountain with a stone runic plaque above it."
    textGo      "You walk into the cave."
    open        isAlreadyOpen

- enterCaveBlocked
    condition   { return !(*enterCave->condition)(); }
    description "a cave entrance to the east"
    tags        "east", "entrance"
    location    field
    prospect    cave
    details     "The entrace is a wide opening in the mountain with a stone runic plaque above it."
    textGo      "The guard is stopping you from entering the cave."
    open        isAlreadyOpen

- exitCave
    description "an exit to the west"
    tags        "west", "exit"
    location    cave
    destination field
    details     "The moon hangs in the sky in the opening through the cave wall."
    textGo      "You leave the cave."
    open        isAlreadyOpen

- enterForest
    description "a forest entrance to the west"
    tags        "forest entrance"
    location    field
    prospect    forest
    details     "The entrance is a gravel pathway with twisted trees forming the circular opening."
    textGo      "There is nothing stopping you from going forward."

- exitForest
    description "an exit to the east"
    tags        "forest exit"
    location    forest
    destination field
    details     "The moon hangs above the sky that can be made out through the tree cover."
    textGo      "You walk out of the dark forest."

- wallField
    description "flat grass all around"
    tags        "west", "north", "south", "grass"
    location    field
    details     "The field is surrounded by trees, roots, and undergrowth."
    textGo      "Dense forest growth is blocking the way."

- wallCave
    description "solid rock all around"
    tags        "east", "north", "rock"
    location    cave
    details     "Carved into the stone is a secret password 'abcd'."
    textGo      "Solid rock is blocking the way."

- backroom
    description "a backroom"
    tags        "backroom"
    details     "The room is dusty and messy."
    capacity    9999

- wallBackroom
    description "solid rock all around"
    tags        "east", "west", "south", "rock"
    location    backroom
    details     "Rocky walls with embedded black stones."
    textGo      "Solid rock is blocking the way."

- openDoorToBackroom
    description "an open door to the south"
    tags        "south", "door", "doorway"
    destination backroom
    details     "The door is open."
    textGo      "You walk through the door into the backroom."
    open        isAlreadyOpen
    close       toggleDoorToBackroom

- closedDoorToBackroom
    description "a closed door to the south"
    tags        "south", "door", "doorway"
    location    cave
    prospect    backroom
    details     "The door is closed."
    textGo      "The door is closed."
    open        toggleDoorToBackroom
    close       isAlreadyClosed

- openDoorToCave
    description "an open door to the north"
    tags        "north", "door", "doorway"
    destination cave
    details     "The door is open."
    textGo      "You walk through the door into the cave."
    open        isAlreadyOpen
    close       toggleDoorToCave

- closedDoorToCave
    description "a closed door to the north"
    tags        "north", "door", "doorway"
    location    backroom
    prospect    cave
    details     "The door is closed."
    textGo      "The door is closed."
    open        toggleDoorToCave
    close       isAlreadyClosed

- openBox
    description "a wooden box"
    tags        "box", "wooden box"
    details     "The box is open."
    weight      5
    capacity    20
    open        isAlreadyOpen
    close       toggleBox
    lock        isStillOpen
    unlock      isAlreadyOpen

- closedBox
    description "a wooden box"
    tags        "box", "wooden box"
    details     "The box is closed."
    weight      5
    open        toggleBox
    close       isAlreadyClosed
    lock        toggleBoxLock
    unlock      isAlreadyUnlocked

- lockedBox
    description "a wooden box"
    tags        "box", "wooden box"
    location    backroom
    details     "The box is closed."
    weight      5
    open        isStillLocked
    close       isAlreadyClosed
    lock        isAlreadyLocked
    unlock      toggleBoxLock

- keyForBox
    description "a tiny key"
    tags        "key", "tiny key"
    location    cave
    details     "The key is really small and shiny."
    weight      1